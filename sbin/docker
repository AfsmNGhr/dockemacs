#!/usr/bin/env sh

# args :
#
#   ps --format="[{{json .ID}},{{json .Image}},{{json .Command}}, \
#                 {{json.RunningFor}},{{json .Status}},{{json .Ports}}, \
#                 {{json .Names}}]" -a

cat /dev/null > /tmp/docker.out

args=''

for i in "$@"; do
    case "$i" in
        *\'*)
            i=$(printf "%s" "$i" | sed "s/'/'\"'\"'/g")
            ;;
        *) : ;;
    esac
    args="$args '$i'"
done

echo "$args"

if [ "$args" != *"exec"* ]; then
  ssh "$HOST_USER@$HOST_IP" -p "$HOST_PORT" -T docker "$args" >> /tmp/docker.out
  cat /tmp/docker.out
else
  ssh "$HOST_USER@$HOST_IP" -p "$HOST_PORT" -tt docker "$args"
fi
