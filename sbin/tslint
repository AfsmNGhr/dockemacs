#!/usr/bin/env sh

cat /dev/null > /tmp/tslint.out
args="$(printf "%s\t" "$@")"

# args :
#
#   --format json --config /local/path/tslint.json \
#   --project /local/path/tsconfig.json /local/path/flycheck_*.ts

args=$(echo "$args" | sed -e 's/'flycheck_/'/g' \
                          -e "s|'$PROJECT_LOCAL_PATH'|'$PROJECT_REMOTE_PATH'|g")
echo "$args"

cmd="$(echo "$PROJECT_TSLINT_CMD" | sed -e "s/tslint'''/tslint/g")"

ssh "$HOST_USER@$HOST_IP" -p "$HOST_PORT" -tt \
    "$cmd $args'" >> /tmp/tslint.out

code="$?"

cat /tmp/tslint.out
exit "$code"
