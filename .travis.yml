services:
  - docker

install:
  - docker build -t afsmnghr/emacs .
  - docker run --rm -it --name emacs afsmnghr/emacs /bin/bash

script:
  - docker exec -it /bin/sh -c "cd \"$HOME/.emacs.d\" && \
    git pull origin master && \
    (bundle check || bundle install --path \"$HOME/.emacs.d/bundle\") && \
    npm install && export PATH=\"$(npm bin):$PATH\" && \
    emacs --version && ./test-startup"
